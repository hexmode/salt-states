<?php
# vi set ai syntax=php

## Managed by Salt Stack, please DO NOT TOUCH, or ALL CHANGES WILL be LOST!

error_reporting( -1 );
ini_set( 'display_errors', 1 );
#$wgDebugToolbar = true;

$wgShowExceptionDetails = true;

##$logDir = '/vagrant/logs';
##$wgDebugLogFile = "{$logDir}/mediawiki-debug.log";

## Calls to deprecated methods will trigger E_USER_DEPRECATED errors
## in the PHP error log.
#$wgDevelopmentWarnings = true;

## Expose debug info for SQL errors.
#$wgDebugDumpSql = true;
#$wgShowDBErrorBacktrace = true;
#$wgShowSQLErrors = true;

## Deployment specific details
{% if salt['grains.get']('level') == 'staging' -%}
$siteTopLevelDomain = 'webplatformstaging.org';
$wgPiwikIDSite = 0;
$wgSitename = "WebPlatform Docs [STAGING]";
$wgDefaultRobotPolicy = 'noindex,nofollow';
{% else -%}
$siteTopLevelDomain = 'webplatform.org';
$wgSitename = "WebPlatform Docs";
$wgDefaultRobotPolicy = 'index,follow';
{% endif %}

## ref: http://www.mediawiki.org/wiki/Manual:$wgCanonicalServer
$wgServer = "//docs.".$siteTopLevelDomain;
$wgCanonicalServer = "https://docs.".$siteTopLevelDomain;
$wgCompatablesJsonFileUrl = "https://docs.".$siteTopLevelDomain."/compat/data.json";

foreach(
  array_merge(
    glob( __DIR__ . '/../settings.d/*.php' ),
    glob( __DIR__ . "/../local.d/*.php" )
  ) as $conffile
) {
  include_once $conffile;
}

require_once( "$IP/../LocalSettings.php" );
require_once( "$IP/../../Settings.php" );
