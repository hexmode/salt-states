server {
    listen      80;
    server_name ssl.webplatform.org;

    return      301  https://ssl.webplatform.org$request_uri;
}

server {
    listen              443 ssl spdy;
    server_name         ssl.webplatform.org;

    ssl                 on;
    ssl_certificate     /etc/ssl/webplatform/webplatform.pem;
    ssl_certificate_key /etc/ssl/webplatform/webplatform.key;

    location /oauth {
      proxy_pass              http://localhost:6284;
      proxy_set_header        X-Real-IP         $remote_addr;
    }

    location /api/docs {
      # TODO, make a server pool for all app* servers.
      proxy_pass                http://10.0.0.18/w/api.php;
      proxy_set_header          Host            'docs.webplatform.org';
      proxy_set_header          X-Real-IP       $remote_addr;
    }

    # Proxying horizon? http://alex.shvid.com/2012/11/02/openstack-dashboard-customization.html
    #location /horizon {
    #  proxy_pass              https://208.113.157.157/horizon;
    #  proxy_set_header        X-Forwarded-Host  $host;
    #  proxy_set_header        X-Forwarded-Protocol https;
    #  proxy_set_header        X-Forwarded-Ssl  on;
    #}
    #location /static {
    #  proxy_pass              http://208.113.157.157/static;
    #}

    #location /wiki {
    #  proxy_pass               http://test:80/wiki
    #  proxy_set_header         Host              $host;
    #  proxy_set_header         X-Forwarded-For   $proxy_add_x_forwarded_for;
    #  proxy_set_header         X-Forwarded-Port  $server_port;
    #  proxy_set_header         X-Forwarded-Host  $host;
    #  proxy_set_header         X-FORWARDED-PROTO https;
    #}

    access_log  /var/log/nginx/access.log;
    error_log   /var/log/nginx/error.log;
}
