{%- set saltProvidedData = salt['publish.publish']('*', 'grains.item', 'host,ipaddr') -%}
{%- set saltMaster = salt['publish.publish']('salt', 'grains.item', 'host,ipaddr') %}
#
# Managed by Salt stack. Do NOT EDIT directly!
#
127.0.0.1	localhost
127.0.1.1	{{ salt['grains.get']('host') }}.staging.wpdn {{ salt['grains.get']('host') }}

# This entry is essential to allow rsync, needs improvements #TODO
10.10.10.40     salt.wpdn   # Hardcoded salt-master as dns.server #TODO

#HOSTS#
#{% for a, iter in saltProvidedData.items() -%}
#{{ iter.get('ipaddr') }}	{{ iter.get('host') }}.staging.wpdn  {{ iter.get('host') }}
#{% endfor -%}
{% for node, args in pillar.get('nodes', {}).items() -%}
{{ args.get('private') }}	{{ node }}.staging.wpdn  {{ node }}		# Provided by a pillar in salt:/srv/pillar/nodes
{% endfor -%}
#/HOSTS#

# The following lines are desirable for IPv6 capable hosts
::1 ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts

# Managed by Salt stack, appended entries
# START managed hosts -DO-NOT-EDIT---
# END managed hosts
